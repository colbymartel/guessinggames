<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Guess The Stranger</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --blue-600:#3b7bbf;
  --blue-700:#2a5a8a;
  --bg1:#5E88A8;
  --bg2:#4F7EA1;
  --surface:#ffffff;
  --text:#333333;
  --muted:#667085;
  --border:#e6e8ef;
  --green:#4CAF50;
  --yellow:#FFD54F;
  --red:#E53935;
  --shadow-xs:0 1px 2px rgba(17,24,39,.06);
  --shadow-sm:0 2px 8px rgba(17,24,39,.08);
  --radius:18px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Montserrat',system-ui;
  background:linear-gradient(160deg,var(--bg1),var(--bg2));
  color:var(--text);
  display:flex;
  justify-content:center;
}

.game{
  width:100%;
  max-width:800px;
  padding:40px 20px 60px;
}

h1{
  text-align:center;
  margin:0 0 24px;
  font-size:28px;
  color:#ffffff;
  font-weight:800;
}

/* HUD */
.hud{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px;
  display:flex;
  justify-content:space-between;
  box-shadow:var(--shadow-sm);
  margin-bottom:30px;
}

.stat{
  text-align:center;
  flex:1;
}

.stat-label{
  font-size:12px;
  color:var(--muted);
  font-weight:600;
  margin-bottom:6px;
}

.stat-value{
  font-size:20px;
  font-weight:700;
}

/* BOARD */
.board{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:28px;
  margin-bottom:40px;
}

.previous-container{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px 28px;
  box-shadow:var(--shadow-xs);
  transition:.2s ease;
}

.previous-container.active{
  box-shadow:var(--shadow-sm);
}

.row{
  display:flex;
  gap:14px;
  justify-content:center;
}

.tile{
  width:64px;
  height:74px;
  border-radius:14px;
  background:#eef2f7;
  border:1px solid var(--border);
  font-size:26px;
  font-weight:700;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:.15s ease;
}

.correct{ background:var(--green); color:#fff; border:none; }
.present{ background:var(--yellow); border:none; }
.wrong{ background:var(--red); color:#fff; border:none; }

/* KEYBOARD */
.keyboard{
  max-width:600px;
  margin:0 auto;
  display:flex;
  flex-direction:column;
  gap:10px;
}

.key-row{
  display:flex;
  justify-content:center;
  gap:8px;
}

.key{
  flex:1;
  max-width:42px;
  padding:12px 0;
  border-radius:12px;
  background:var(--surface);
  border:1px solid var(--border);
  font-weight:600;
  cursor:pointer;
  text-align:center;
  box-shadow:var(--shadow-xs);
  transition:.12s ease;
}

.key:hover{ background:#edf2fb }
.key.correct{ background:var(--green); color:#fff; border:none }
.key.present{ background:var(--yellow); border:none }
.key.wrong{ background:var(--red); color:#fff; border:none }

.wide{
  flex:2;
  max-width:90px;
}

.message{
  text-align:center;
  margin-top:20px;
  font-weight:700;
  color:#ffffff;
}

.play-again{
  display:none;
  margin:20px auto 0;
  padding:10px 20px;
  border-radius:999px;
  border:1px solid var(--blue-600);
  background:var(--blue-600);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}

</style>
</head>
<body>

<div class="game">

<h1>Guess The Stranger</h1>

<div class="hud">
  <div class="stat">
    <div class="stat-label">Attempts</div>
    <div class="stat-value" id="attempts">0</div>
  </div>
  <div class="stat">
    <div class="stat-label">Time</div>
    <div class="stat-value"><span id="timer">0</span>s</div>
  </div>
  <div class="stat">
    <div class="stat-label">Best</div>
    <div class="stat-value" id="bestScore">--</div>
  </div>
</div>

<div class="board">
  <div class="previous-container" id="previousContainer">
    <div class="row" id="previousRow"></div>
  </div>
  <div class="row" id="currentRow"></div>
</div>

<div class="keyboard" id="keyboard"></div>

<div class="message" id="message"></div>
<button class="play-again" id="playAgainBtn">Play Another Name</button>

</div>

<script>

/* Same game logic as before */

const names=["OLIVIA","JACKSON","EMMA","NOAH","AVA","LUCAS","SOPHIA","MASON","TIMMY","COLBY","JUSTIN","JEFFREY","CASSIDY","JADE","GRACIE","VICTORIA"];

let target,currentGuess,attempts,time,gameOver,timerInterval;

const previousRow=document.getElementById("previousRow");
const currentRow=document.getElementById("currentRow");
const previousContainer=document.getElementById("previousContainer");
const playAgainBtn=document.getElementById("playAgainBtn");

let best=localStorage.getItem("bestTime");
if(best)document.getElementById("bestScore").innerText=best+"s";

function startGame(){
  target=names[Math.floor(Math.random()*names.length)];
  currentGuess="";attempts=0;time=0;gameOver=false;
  document.getElementById("attempts").innerText=0;
  document.getElementById("timer").innerText=0;
  document.getElementById("message").innerText="";
  playAgainBtn.style.display="none";
  previousRow.innerHTML="";currentRow.innerHTML="";
  createRow(previousRow);createRow(currentRow);
  document.querySelectorAll(".key").forEach(k=>k.classList.remove("correct","present","wrong"));
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{if(!gameOver){time++;document.getElementById("timer").innerText=time}},1000);
}

function createRow(row){
  for(let i=0;i<target.length;i++){
    const tile=document.createElement("div");
    tile.classList.add("tile");
    row.appendChild(tile);
  }
}

function updateCurrentRow(){
  const tiles=currentRow.children;
  for(let i=0;i<target.length;i++){
    tiles[i].innerText=currentGuess[i]||"";
    tiles[i].className="tile";
  }
}

function submitGuess(){
  if(currentGuess.length !== target.length) return;

  attempts++;
  document.getElementById("attempts").innerText = attempts;

  const tiles = previousRow.children;

  // Build frequency map of target letters
  const letterCount = {};
  for (let letter of target) {
    letterCount[letter] = (letterCount[letter] || 0) + 1;
  }

  // FIRST PASS — mark correct (green)
  const result = Array(target.length).fill("wrong");

  for (let i = 0; i < target.length; i++) {
    if (currentGuess[i] === target[i]) {
      result[i] = "correct";
      letterCount[currentGuess[i]]--;
    }
  }

  // SECOND PASS — mark present (yellow) if remaining count
  for (let i = 0; i < target.length; i++) {
    if (result[i] === "correct") continue;

    const letter = currentGuess[i];

    if (letterCount[letter] > 0) {
      result[i] = "present";
      letterCount[letter]--;
    } else {
      result[i] = "wrong";
    }
  }

  // Apply results to tiles + keyboard
  for (let i = 0; i < target.length; i++) {
    tiles[i].innerText = currentGuess[i];
    tiles[i].className = "tile " + result[i];

    const keyButton = [...document.querySelectorAll(".key")]
      .find(k => k.innerText === currentGuess[i]);

    if (result[i] === "correct") {
      keyButton?.classList.remove("present","wrong");
      keyButton?.classList.add("correct");
    } 
    else if (result[i] === "present") {
      if (!keyButton?.classList.contains("correct")) {
        keyButton?.classList.add("present");
      }
    } 
    else {
      if (!keyButton?.classList.contains("correct") &&
          !keyButton?.classList.contains("present")) {
        keyButton?.classList.add("wrong");
      }
    }
  }

  if(currentGuess === target){
    gameOver = true;
    document.getElementById("message").innerText =
      `You got it in ${attempts} attempts and ${time}s!`;

    if(!best || time < best){
      localStorage.setItem("bestTime", time);
      document.getElementById("bestScore").innerText = time + "s";
    }

    playAgainBtn.style.display = "block";
  }

  currentGuess = "";
  updateCurrentRow();
}


playAgainBtn.onclick=startGame;

const layout=["QWERTYUIOP","ASDFGHJKL","ENTERZXCVBNMBACK"];
layout.forEach(row=>{
  const rowDiv=document.createElement("div");rowDiv.classList.add("key-row");
  if(row==="ENTERZXCVBNMBACK"){
    addKey("ENTER",rowDiv,true);
    "ZXCVBNM".split("").forEach(l=>addKey(l,rowDiv));
    addKey("⌫",rowDiv,true);
  }else row.split("").forEach(l=>addKey(l,rowDiv));
  document.getElementById("keyboard").appendChild(rowDiv);
});

function addKey(letter,parent,wide=false){
  const key=document.createElement("div");
  key.classList.add("key");if(wide)key.classList.add("wide");
  key.innerText=letter;
  key.onclick=()=>handleKey(letter);
  parent.appendChild(key);
}

function handleKey(key){
  if(gameOver)return;
  if(key==="ENTER")submitGuess();
  else if(key==="⌫"){currentGuess=currentGuess.slice(0,-1);updateCurrentRow();}
  else if(currentGuess.length<target.length){currentGuess+=key;updateCurrentRow();}
}

document.addEventListener("keydown",(e)=>{
  if(gameOver)return;
  if(e.key==="Enter")submitGuess();
  else if(e.key==="Backspace")handleKey("⌫");
  else if(/^[a-zA-Z]$/.test(e.key))handleKey(e.key.toUpperCase());
});

startGame();

</script>
</body>
</html>
